"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5fa81c3c-4fc6-5b68-9b23-fb49047abae2")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[1092],{494874:(e,t,o)=>{o.d(t,{$7:()=>i,Lp:()=>s,UD:()=>C,cA:()=>m,ik:()=>l,kK:()=>c,kX:()=>f,n0:()=>d,o1:()=>h,pG:()=>r,pN:()=>u,r3:()=>b,u6:()=>p,up:()=>n,xT:()=>g,xu:()=>_,xw:()=>a});let n="feed_composer--feedEditableTypeahead--jvsZg thread_comment_composer--editableTypeahead--9R6Yd text--fontPos13--xW8hS text--_fontBase--QdLsd",r="feed_composer--feedComposerBorder--k-qZ-",s="feed_composer--feedComposerMinimized--0NEpg",i="feed_composer--feedComposerUnfocused--LOiym feed_composer--feedComposer--Nbrsq",a="feed_composer--fileChip--XRac9",l="feed_composer--feedComposerFocused--u6-Rw feed_composer--feedComposer--Nbrsq",c="feed_composer--unifiedComposerContainer--Ic9sg thread_comment_composer--inputSectionWrapper--Bxyab",d="feed_composer--descriptionComposer--s0uuh feed_composer--descriptionComposerBase--3m1hj",m="feed_composer--commentDescriptionComposer--x8T69 feed_composer--descriptionComposerBase--3m1hj",u="feed_composer--composerTitle--qo0b-",p="feed_composer--composerTitleOverLimit--46wRP feed_composer--composerTitle--qo0b-",f="feed_composer--composerTitleEmpty--F9FJ- feed_composer--composerTitle--qo0b-",g="feed_composer--composerDescription--p5mkK",C="feed_composer--composerDescriptionEmpty--MNM0g feed_composer--composerDescription--p5mkK",h="feed_composer--actions--4DVzj thread_comment_composer--actions--7LRnN",_="feed_composer--leftComposerButtonGroup--dQdxH thread_comment_composer--leftComposerButtonGroup--6jQ3I",b="feed_composer--fileChipAttached--yUL6s feed_composer--fileChip--XRac9"},801092:(e,t,o)=>{o.r(t),o.d(t,{FeedPostCommentComposer:()=>K,FeedPostUnifiedComposer:()=>W});var n=o(848318),r=o(716544),s=o(536384),i=o.n(s),a=o(514246),l=o(387784),c=o(193324),d=o(303035),m=o(26039),u=o(166365),p=o(442313),f=o(657507),g=o(196484),C=o(859470),h=o(650309),_=o(369600),b=o(707717),E=o(830789),k=o(503024),T=o(688637),y=o(819382),I=o(835491),D=o(524987),F=o(246633),R=o(798918),v=o(166436),w=o(988720),x=o(583518),B=o(494874),O=o(579898),A=o(246355),S=o(473677),N=o(545021);let M="feed-post-title-placeholder",P="feed-post-title",L="feed-post-title-danger";function K(e){let t;let o=(0,r.wA)(),s=(0,y._B)(),i=n.useRef(null),a=n.useRef(null),l=n.useRef(null),{onSubmit:m,onCancel:u,updateMessage:f}=e,g=n.useCallback(()=>{if(u){i.current&&i.current.hasFocus()&&a.current?.focus(),u(),s.onClear();return}(0,c.I)(e.messageContent)?i.current&&i.current.hasFocus()&&a.current?.focus():(f([]),s.onClear()),l.current?.visible&&l.current.clearDecorators()},[l,e.messageContent,u,f,s]),C=n.useMemo(()=>(0,c._Z)(e.messageContent,{includeTrailingWhitespace:!0}).length,[e.messageContent]),h=n.useCallback(()=>{(0,c.I)(e.messageContent)||e.maxCommentLength&&C>e.maxCommentLength||(m&&m(),i.current&&i.current.hasFocus()&&a.current?.focus(),s.onClear())},[m,e.messageContent,s,C,e.maxCommentLength]),_=(0,r.d4)(e=>e.comments.typeahead),b=n.useCallback(e=>e,[]);return a.current&&(t=a.current.getBoundingClientRect()),n.createElement(n.Fragment,null,n.createElement("div",{ref:a,tabIndex:0,className:B.cA},n.createElement(D.C,{fallback:null,errorFallback:null,dispatch:o,editorRef:i,typeahead:_,onCancel:g,onSubmit:h,user:e.user,threadPosition:null,viewportPositionFromClientPosition:b,submitText:(0,p.t)("comments.post"),placeholderText:e.placeholderText?e.placeholderText:(0,p.t)("fig_feed.add_a_comment"),editorOnClear:s.editorOnClear,editorOnInsert:s.editorOnInsert,setIsEditorFocused:s.setIsEditorFocused,messageMeta:e.messageContent,threadId:E.hm,fileKey:null,editingExistingComment:e.editingExistingComment,recordingKey:E.Dw.feed,mountInputFocused:e.autofocus,hideEmojiPicker:!1,allowAttachments:!0,attachments:e.attachments,deleteAttachment:e.deleteAttachment,updateAttachment:e.updateAttachment,updateMessage:e.updateMessage,mentionables:e.mentionables,scrollToBottom:e.scrollToBottom?e.scrollToBottom:d.lQ,containerClassName:e.composerContainerClass,editableTypeaheadClassName:e.editableTypeaheadClass,hideSubmitButton:e.hideSubmitButton,submitOnEnter:e.submitOnEnter,editorType:"comment-editor-feed",maintainSelectionOnFocus:!0})),!(0,c.I)(e.messageContent)&&t&&n.createElement(T.Uu,{decoratorsRef:l,onClear:s.onClear,onInsert:s.onInsert,width:t.width,direction:e.displayDecoratorsDownwards?R.ri.DOWNWARDS:R.ri.UPWARDS,targetRect:t,useFixedPosition:!0}))}function W(e){let t;let o=(0,r.wA)(),s=(0,y._B)(),E=n.useRef(null),D=n.useRef(null),K=n.useRef(null),{onSubmit:W,updateTitle:U,updateDescription:j,openPostFromFileModal:X}=e,q=n.useCallback(()=>{ec(!1),E.current&&E.current.hasFocus()&&e.parentRef?.current&&e.parentRef.current.focus(),K.current?.visible&&K.current.clearDecorators()},[K,e.parentRef]),z=n.useCallback(()=>{(0,c.I)(e.description)||(W&&W(),s.onClear())},[W,e.description,s]),$=(0,r.d4)(e=>e.comments.typeahead);D.current&&(t=D.current.getBoundingClientRect());let[G,Q]=n.useState(!1),Y=n.useRef(null);(0,f.L)(Y,()=>Q(!1),!0);let Z=n.useMemo(()=>(0,c.I)(e.description),[e.description]),H=n.useMemo(()=>!e.title&&Z,[e.title,Z]),V=n.useMemo(()=>[{t:"\n"},{t:"\n"}],[]),[J,ee]=n.useState(H?V:[{t:`${e.title}
`}].concat(e.description)),[et,eo]=n.useState(!1),[en,er]=n.useState(void 0),es=n.useCallback(([e,t])=>{let o=t.getCurrentContent().getFirstBlock(),n=t.getCurrentContent().getBlocksAsArray();n.shift();let r=o.getKey(),s=o.getText();er(r);let i=a.ContentState.createFromBlockArray(n),l=a.EditorState.createWithContent(i),c=(0,w.yN)(l);eo(r===t.getSelection().getEndKey()),U(s),j(c),0===n.length?(ee([...e,...V]),setTimeout(()=>{E.current?.moveFocusBefore()},0)):ee(e)},[U,j,V]),ei=n.useMemo(()=>{let t={};return en&&(e.title?t[en]=e.title.length>x.Y?L:P:t[en]=M),t},[en,e.title]),ea=n.useCallback(t=>t.getType()===M?B.kX:t.getType()===P?B.pN:t.getType()===L?B.u6:(0,c.I)(e.description)?B.UD:B.xT,[e.description]);n.useEffect(()=>{e.minimized&&Q(!1)},[e.minimized]);let[el,ec]=n.useState(!1),[ed,em]=n.useState(!1),eu=n.useRef(null),ep=(0,_.q5)(),ef=ep?.key||null,eg=ep?.teamId,eC=(0,r.d4)(e=>e.orgUsersByOrgId),eh=(0,r.d4)(e=>e.dropdownShown||null),e_=(0,r.d4)(e=>e.comments.editingComment),eb=n.useCallback(()=>(E.current&&E.current.handleEscape(),!1),[]),eE=n.useCallback(()=>{Q(!0),el||ec(!0)},[el]),ek=n.useRef(null),eT=e=>{if(E&&E.current){let t=l.dN.get(e.id);t&&E.current.insertEmoji(t),o(g.RI({visible:!1}))}},ey=async()=>{et||(o(g.We(await (0,b.fG)("",e.mentionables,!1))),em(!0),setTimeout(()=>{em(!1)},250),E.current?.focus(!1))},eI=(0,h.$)(),eD=n.useMemo(()=>e.fileData?eI(e.fileData):void 0,[e.fileData,eI]);return n.createElement("div",{className:i()(e.minimized?B.Lp:G?B.ik:B.$7,B.pG),ref:Y,onBlur:()=>Q(!1),style:{"--feed-post-title-placeholder":`"${(0,p.t)("fig_feed.give_your_post_a_title")}"`,"--feed-post-description-placeholder":`"${(0,p.t)("fig_feed.dive_into_the_details")}"`}},!e.minimized&&n.createElement("div",{ref:D,className:B.n0},n.createElement("div",{className:B.kK,ref:eu,"data-testid":"comment-composer-container"},n.createElement(C.$W,{handleEscape:eb,priority:C.KD.EDITING_TEXT_FIELD},n.createElement(v.iX,{ref:E,editorType:"comment-editor-feed",editorRef:E,dispatch:o,delegateEscapeHandling:!0,typeahead:$,mentionables:e.mentionables,onUpdateTextArea:d.lQ,onSubmit:z,onFocus:eE,onCancel:q,editorOnClear:s.editorOnClear,editorOnInsert:s.editorOnInsert,setIsEditorFocused:s.setIsEditorFocused,updateMessage:es,messageMeta:J,className:e.editableTypeaheadClass,mountInputFocused:e.autofocus,initMention:ed,submitOnEnter:e.submitOnEnter??!0,user:e.user,openFileKey:ef,currentOrgId:e.currentOrgId,openFileTeamId:eg,currentOrgUsers:eC,readOnly:e.readOnly,dropdownShown:eh??void 0,editingComment:e_??void 0,isProtoView:!1,blockStyleFn:ea,blockKeyToType:ei,updateMessageOnMount:!0,moveFocusToStartOnMount:H,maintainSelectionOnFocus:!0,feedTitleBlockKey:en})),n.createElement("div",{className:B.o1},n.createElement("div",{className:B.xu},I.Y&&n.createElement(F.K0,{svg:A.A,onClick:()=>{let e=ek.current?.getBoundingClientRect();e&&o(g.RI({visible:!0,targetRect:e,onPick:eT}))},ref:ek,onMouseDown:e=>e.stopPropagation(),"data-tooltip-type":k.Ib.TEXT,"data-tooltip":(0,p.t)("comments.add_emoji"),dataTestId:"emoji-picker-button",recordingKey:"emojiPicker",disabled:!1}),n.createElement(F.K0,{tabIndex:Z?-1:0,svg:O.A,onClick:ey,onMouseDown:e=>e.stopPropagation(),"data-tooltip-type":k.Ib.TEXT,"data-tooltip":(0,p.t)("comments.add_mention"),disabled:Z||et,recordingKey:"mentionButton"})),!e.editingPost&&(e.fileData||!e.lockFileAddition)&&n.createElement("div",{className:e.fileData?B.r3:B.xw,onClick:e.readOnly||e.lockFileAddition?void 0:X,role:"button",tabIndex:0},e.fileData&&void 0!==eD?n.createElement(n.Fragment,null,n.createElement(m.MW,{type:eD,size:m.LE.SMALL}),e.fileData.name):n.createElement(n.Fragment,null,n.createElement(u.B,{svg:S.A}),(0,p.t)("fig_feed.link_figma_file")),e.fileData&&e.canUnlinkFile&&n.createElement(u.B,{svg:N.A,onClick:t=>{t.stopPropagation(),e.unlinkFile?.()}}))))),t&&n.createElement(T.Uu,{decoratorsRef:K,onClear:s.onClear,onInsert:s.onInsert,width:t.width,direction:e.displayDecoratorsDownwards?R.ri.DOWNWARDS:R.ri.UPWARDS,targetRect:t,useFixedPosition:!0,mentionsDisabled:et}))}},583518:(e,t,o)=>{o.d(t,{Y:()=>n,e:()=>r});let n=80,r=3e3}}]);

//# debugId=5fa81c3c-4fc6-5b68-9b23-fb49047abae2

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/9dfdcb6ca488ce22095f525205a124e69e516d25/1092-bfe77f0cc8506aed.min.js.map